global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # Self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Loki metrics
  - job_name: 'loki'
    static_configs:
      - targets: ['loki:3100']

  # cAdvisor metrics from kubelet via API server proxy
  - job_name: 'kubelet-cadvisor'
    scheme: https
    tls_config:
      ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
      insecure_skip_verify: true
    bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
    static_configs:
      - targets: ['kubernetes.default.svc:443']
    metrics_path: /api/v1/nodes/k3d-nebula-server-0/proxy/metrics/cadvisor

  # TODO(NEBULA-wlh): Add Temporal server and worker scrape configs
